<div class="login-container">
  <mat-card class="login-card">
    <mat-card-header>
      <mat-card-title>
        {{ isRegisterMode() ? "Create Account" : "Welcome Back" }}
      </mat-card-title>
      <mat-card-subtitle>
        {{
          isRegisterMode() ? "Sign up to get started" : "Sign in to continue"
        }}
      </mat-card-subtitle>
    </mat-card-header>
    <mat-card-content>
      <form [formGroup]="form" (ngSubmit)="onSubmit()" class="login-form">
        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Username</mat-label>
          <input
            matInput
            formControlName="username"
            placeholder="Enter username"
          />
          @if (form.get('username')?.hasError('required')) {
          <mat-error>Username is required</mat-error>
          } @if (form.get('username')?.hasError('minlength')) {
          <mat-error>Username must be at least 3 characters</mat-error>
          }
        </mat-form-field>

        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Password</mat-label>
          <input
            matInput
            type="password"
            formControlName="password"
            placeholder="Enter password"
          />
          @if (form.get('password')?.hasError('required')) {
          <mat-error>Password is required</mat-error>
          } @if (form.get('password')?.hasError('minlength')) {
          <mat-error>Password must be at least 6 characters</mat-error>
          }
        </mat-form-field>

        @if (error()) {
        <mat-card appearance="outlined" class="error-card">
          <mat-card-content>
            <div class="error-content">
              <mat-icon color="warn">error</mat-icon>
              <span>{{ error() }}</span>
            </div>
          </mat-card-content>
        </mat-card>
        }

        <button
          mat-raised-button
          color="primary"
          type="submit"
          [disabled]="form.invalid || loading()"
          class="submit-button"
        >
          @if (loading()) {
          {{ isRegisterMode() ? "Creating..." : "Logging in..." }} } @else {
          {{ isRegisterMode() ? "Register" : "Login" }} }
        </button>

        <button
          mat-button
          type="button"
          (click)="toggleMode()"
          [disabled]="loading()"
          class="toggle-button"
        >
          {{
            isRegisterMode()
              ? "Already have an account? Login"
              : "Don't have an account? Register"
          }}
        </button>
      </form>
    </mat-card-content>
  </mat-card>
</div>
